<my-app>
  <div>
    <h1>Thie is Riot test.</h1>
    <p>{ state.test }</p>
    <p>
      <button class="unmount-animation" onclick="{ animationUnmount }" data-ref="button">
        my-appをアンマウント
      </button>
    </p>
    <p>
      <raw-html data-html="コンポーネントのテスト"></raw-html>
    </p>
  </div>

  <style>
    h1 {
      color: green;
      display: flex;
    }

    .unmount-animation {
      opacity: 1;
      transition: opacity 1s;
    }

    .unmount-animation.is-unmount {
      opacity: 0;
    }
  </style>

  <script>
    export default {
      state: {
        finishAnimation: false,
        test: 'Hello Riot!'
      },
      onMounted() {
        const burst = new this.mojs.Burst({
          parent: this.$('[data-ref="button"]'),
          radius: { 0: 100 },
          count: 5,
          children: {
            shape: 'polygon',
            fill: { 'cyan': 'yellow' },
            radius: 20,
            rotate: { 360: 0 },
            duration: 1000
          }
        })

        const buttonAnimation = new this.mojs.Html({
          el: this.$('[data-ref="button"]'),
          x: { 0: "20px" },
          easing: 'sin.inout',
          duration: 1000,
          repeat: 999,
          isYoyo: true,
          onRepeatComplete() {
            burst.replay()
          }
        })
          .play()
        // new this.MojsPlayer({ add: buttonAnimation });

      },
      animationUnmount(e) {
        this.$('[data-ref="button"]').addEventListener('transitionend', (e) => {
          console.log('button transitionend')
          this.unmount()
        })
        this.$('[data-ref="button"]').classList.add('is-unmount')
      }
    }
  </script>
</my-app>